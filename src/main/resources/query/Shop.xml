<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.red.xip.shop.mapper.ShopMapper">

	<select id ="selectDetailAccount"
			parameterType = "com.red.xip.shop.model.P_Shop"
			resultType="com.red.xip.shop.model.R_Shop">
	<![CDATA[
		SELECT  IFNULL(M.EMAIL, '') AS EMAIL,
		        IFNULL(M.LAST_NM, '') AS LAST_NM,
		        IFNULL(M.FIRST_NM, '') AS FIRST_NM,
                IFNULL(AD.ADD_1, '') AS ADD_1,
                IFNULL(AD.ADD_2, '') AS ADD_2,
                IFNULL(AD.CITY, '') AS CITY,
                IFNULL(AD.STATE, '') AS STATE,
                IFNULL(AD.POSTAL_CD, '') AS POSTAL_CD,
                CASE WHEN IFNULL(AD.ADD_COUNTRY, '') = '' THEN IFNULL(M.COUNTRY,'')
                     ELSE AD.ADD_COUNTRY END AS ADD_COUNTRY
        FROM    XIP_USERS AS M
                INNER JOIN ADDRESSES AS AD
                ON  AD.USER_CD = M.USER_CD
        WHERE   M.USER_CD = CAST(#{userCd}AS UNSIGNED)
        AND     M.EMAIL = #{email}
	]]>
	</select>
	
</mapper>